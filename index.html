<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>CallOut Counter</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      padding: 20px;
      margin: 0;
      background-color: #401E68;
      color: #FFFFFF;
      box-sizing: border-box;
    }
    h1 {
      font-size: 28px;
      text-align: center;
      margin-bottom: 20px;
      color: #FFEB3B;
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
      color: #FFFFFF;
    }
    select, input[type="number"] {
      padding: 10px;
      font-size: 16px;
      width: 100%;
      max-width: 300px;
      margin-bottom: 10px;
      border: 2px solid #FFEB3B;
      border-radius: 5px;
      background-color: #2C1A4F;
      color: #FFFFFF;
      appearance: none;
      background-image: url("data:image/svg+xml;utf8,<svg fill='white' height='24' viewBox='0 0 24 24' width='24' xmlns='http://www.w3.org/2000/svg'><path d='M7 10l5 5 5-5z'/></svg>");
      background-repeat: no-repeat;
      background-position: right 10px center;
      background-size: 16px;
    }
    button {
      margin: 10px 0;
      padding: 12px 18px;
      font-size: 16px;
      width: 100%;
      max-width: 300px;
      border: none;
      border-radius: 5px;
      background-color: #FF5722;
      color: #FFFFFF;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    button:hover {
      background-color: #E64A19;
    }
    #results, #intervalStatus {
      margin-top: 15px;
      font-weight: bold;
      font-size: 16px;
      color: #00E676;
    }
    input[type="checkbox"] {
      transform: scale(1.2);
      margin-right: 8px;
    }
    #calibrateBtn {
      display: inline-block;
    }
    #calibrateBtn.start {
      background-color: #4CAF50;
    }
    #calibrateBtn.stop {
      background-color: #F44336;
    }
    #calibrateBtn.start:hover {
      background-color: #388E3C;
    }
    #calibrateBtn.stop:hover {
      background-color: #D32F2F;
    }
  </style>
</head>
<body>
  <h1>üîÅ CallOut Counter</h1>
  <button onclick="resetCalibration()">Reset üîÑ</button>

  <label for="rangeSelect">Choose Range:</label>
  <select id="rangeSelect">
    <option value="8">1 to 8</option>
    <option value="10">1 to 10</option>
    <option value="12">1 to 12</option>
    <option value="16">1 to 16</option>
  </select>

  <label for="soundMode">Sound Mode:</label>
  <select id="soundMode">
    <option value="beep">Beep</option>
    <option value="read">Read Aloud</option>
  </select>

  <label for="RPM Setting">RPM Setting:</label>
  <button id="calibrateBtn" class="start">Start Point #1 ‚ñ∂Ô∏è</button>

  <label>
    <input type="checkbox" id="useCustomInterval" />
    Use custom interval (seconds):
  </label>
  <input type="number" id="customInterval" value="1" min="0.5" step="0.1" disabled />

  <button id="countBtn">Start Counting ‚ñ∂Ô∏è</button>

  <div id="intervalStatus">‚ö†Ô∏è RPM Unknown</div>
  <div id="results"></div>

  <script>
    let calibratedInterval = null;
    let isCalibrating = false;
    let isCounting = false;
    let intervalId = null;
    let current = 1;
    let startTime = null;

    const calibrateBtn = document.getElementById("calibrateBtn");
    const countBtn = document.getElementById("countBtn");
    const useCustomIntervalCheckbox = document.getElementById("useCustomInterval");
    const customIntervalInput = document.getElementById("customInterval");
    const intervalStatus = document.getElementById("intervalStatus");
    const rangeSelect = document.getElementById("rangeSelect");
    const soundModeSelect = document.getElementById("soundMode");

    const audioContext = new (window.AudioContext || window.webkitAudioContext)();

    calibrateBtn.addEventListener("click", () => {
      if (!isCalibrating) {
        isCalibrating = true;
        startTime = Date.now();
        calibrateBtn.textContent = "Stop Point #1 ‚èπÔ∏è";
        calibrateBtn.classList.remove("start");
        calibrateBtn.classList.add("stop");
        document.getElementById("results").textContent = "‚è≥ Calibrating... Rotate once and click again.";
      } else {
        const duration = Date.now() - startTime;
        calibratedInterval = duration / 10;
        isCalibrating = false;
        calibrateBtn.textContent = "Start Point #1 ‚ñ∂Ô∏è";
        calibrateBtn.classList.remove("stop");
        calibrateBtn.classList.add("start");
        document.getElementById("results").innerHTML =
          `‚úÖ Calibration complete<br>üîÅ Rotation time: ${(duration / 1000).toFixed(2)}s<br>‚è≥ Interval per number: ${(calibratedInterval / 1000).toFixed(2)}s`;
        intervalStatus.textContent = "‚úÖ Using calibrated interval";
      }
    });

    countBtn.addEventListener("click", () => {
      if (!isCounting) {
        isCounting = true;
        countBtn.textContent = "Stop ‚èπÔ∏è";
        current = 1;
        let interval = useCustomIntervalCheckbox.checked
          ? parseFloat(customIntervalInput.value) * 1000
          : calibratedInterval;

        if (!interval) {
          document.getElementById("results").textContent = "‚ö†Ô∏è Please calibrate or set a custom interval.";
          isCounting = false;
          return;
        }

        const maxCount = parseInt(rangeSelect.value);

        intervalId = setInterval(() => {
          if (current > maxCount) {
            current = 1;
          }
          playSound(current);
          current++;
        }, interval);
      } else {
        clearInterval(intervalId);
        speechSynthesis.cancel();
        isCounting = false;
        countBtn.textContent = "Start Counting ‚ñ∂Ô∏è";
        document.getElementById("results").textContent = "‚èπÔ∏è Counting stopped.";
      }
    });

    function resetCalibration() {
      calibratedInterval = null;
      isCalibrating = false;
      isCounting = false;
      current = 1;
      clearInterval(intervalId);
      speechSynthesis.cancel();

      calibrateBtn.textContent = "Start Point #1 ‚ñ∂Ô∏è";
      calibrateBtn.disabled = false;
      calibrateBtn.style.display = "inline-block";
      calibrateBtn.classList.remove("stop");
      calibrateBtn.classList.add("start");

      countBtn.textContent = "Start Counting ‚ñ∂Ô∏è";

      useCustomIntervalCheckbox.checked = false;
      customIntervalInput.disabled = true;
      customIntervalInput.value = "1";

      rangeSelect.selectedIndex = 0;
      soundModeSelect.selectedIndex = 0;

      document.getElementById("results").textContent = "üîÑ RPM Reset.";
      intervalStatus.textContent = "‚ö†Ô∏è RPM Unknown";
    }

    function playSound(number) {
      const mode = soundModeSelect.value;
      if (mode === "read") {
        const utterance = new SpeechSynthesisUtterance(number.toString());
        speechSynthesis.speak(utterance);
      } else {
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        oscillator.type = "square";
        oscillator.frequency.setValueAtTime(number === 1 ? 100: 2000, audioContext.currentTime);
        gainNode.gain.setValueAtTime(number === 1 ? 3 : 1, audioContext.currentTime);
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        oscillator.start();
        oscillator.stop(audioContext.currentTime + 0.05);
      }
    }

        useCustomIntervalCheckbox.addEventListener("change", () => {
      const isChecked = useCustomIntervalCheckbox.checked;
      customIntervalInput.disabled = !isChecked;

      if (isChecked) {
        calibrateBtn.style.display = "none";
      } else {
        calibrateBtn.style.display = "inline-block";
        calibrateBtn.classList.remove("stop");
        calibrateBtn.classList.add("start");
        calibrateBtn.textContent = "Start Point #1 ‚ñ∂Ô∏è";
      }

      intervalStatus.textContent = isChecked
        ? "‚úÖ Using Custom Interval"
        : calibratedInterval
          ? "‚úÖ Using calibrated interval"
          : "‚ö†Ô∏è RPM Unknown";
    });
  </script>
</body>
</html>
